<div class="page" *ngIf="(guidesFound | async) as paginationResponse; else noGuidesFound">
    <div class="align-flex">
        <div class="title">
            <h1>Mis guías guardadas</h1>
        </div>
    </div>
    @if(paginationResponse && paginationResponse.totalGuides > 0) {
    <div class="align-grid">
        @for(guide of paginationResponse.guidesRetrieved; track guide) {
        <mat-card class="example-card guide-card">
            <mat-card-header>
                <mat-card-title>{{ guide.title }}</mat-card-title>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content class="guide-resume">
                <div class="guide-info">
                    <p><strong>Guía sobre:</strong>{{ formatGuideTypes(guide.guideTypes) }}</p>
                    <p><strong>Comentarios:</strong> {{ guide.amountComments }}</p>
                    <p><strong>Puntuación media:</strong> {{ guide.ratingMean === 0 ? 'No puntuada' : guide.ratingMean
                        }}</p>
                </div>
                <div class="guide-info">
                    <img mat-card-image [src]="guide.thumbnail 
              ? 'data:image/jpeg;base64,' + guide.thumbnail 
              : '/assets/images/_11707f36-6180-48c1-b259-16214f3e3e34-logo.jpeg'">
                </div>
            </mat-card-content>
            <mat-divider></mat-divider>
            <mat-card-content>
                <p>
                    {{ guide.description }}
                </p>
            </mat-card-content>
            <mat-card-actions>
                <button mat-button (click)="visualizeGuide(guide.id)">Visualizar guía</button>
                @if(!findGuideIsSaved(guide.id)) {
                <button mat-button color="accent" (click)="addSaved(guide.id)">Añadir a guardados</button>
                }
                @else {
                <button mat-button color="warn" (click)="deleteSaved(guide.id)">Eliminar de guardados</button>
                }
            </mat-card-actions>
        </mat-card>
        }
    </div>
    @if(paginationResponse.totalGuides > 8) {
    <div class="options-bottom">
        <mat-paginator class="mx-2" #paginator [pageSize]="8" [length]="paginationResponse.totalGuides"
            aria-label="Select page" [showFirstLastButtons]="true" (page)="handlePageEvent($event)"
            [pageIndex]="currentPage">
        </mat-paginator>
    </div>
    }
    }
    @else {
    <div class="align-flex">
        <h2>No se han encontrado guías guardadas</h2>
    </div>
    }
</div>
<ng-template #noGuidesFound>
    <div class="page">
        <div class="align-flex">
            <div class="title">
                <h1>Mis guías guardadas</h1>
            </div>
        </div>
        <h2>Cargando información...</h2>
    </div>
</ng-template>