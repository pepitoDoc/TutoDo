<div class="page">
  <div class="alignFlexColumn" *ngIf="guideWatching !== undefined">
    <div class="title">
      <h1>{{ guideWatching.title }}</h1>
    </div>
    <div class="stepContainer">
      <div *ngFor="let step of guideWatching.steps; let i = index;" [class.stepLayout]="true"
        [ngClass]="{ 'stepCompleted': i < currentStep, 'currentStep': i === currentStep, 'stepUncompleted': i > currentStep }">
        <h2 [id]="'step' + i">Paso {{ i + 1 }}</h2>
        <h3>{{ step.title }}</h3>
        <h4>{{ step.description }}</h4>
        <div class="alignFlexRow">
          <button type="button" *ngIf="i === currentStep" (click)="nextStep()" mat-flat-button class="buttonSpace"
            color="primary">Marcar paso como completado</button>
          <button type="button" *ngIf="i === currentStep && i !== 0" (click)="previousStep()" mat-flat-button
            class="buttonSpace" color="accent">Volver al paso anterior</button>
        </div>
      </div>
    </div>
    <mat-progress-bar mode="determinate" class="sticky-bottom"
      [value]="(100 / guideWatching.steps.length) * currentStep"></mat-progress-bar>
  </div>
</div>

<div class="fixed">
  <div class="sideAction">
    <a class="sideButton sideAction" data-bs-toggle="offcanvas" href="#offcanvasSteps" role="button"
      aria-controls="offcanvasSteps">
      <div class="buttonDiv bg-b-blue">
        Pasos de la guía
      </div>
    </a>
    <a class="sideButton sideAction" data-bs-toggle="offcanvas" href="#offcanvasIngredients" role="button">
      <div class="buttonDiv bg-b-orange">
        Ingredientes/materiales
      </div>
    </a>
  </div>
  <!-- <div class="sideHelp">
    <a class="sideButton sideHelp" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button">
      <div class="buttonDiv bg-b-purple">
        Ayuda
      </div>
    </a>
  </div> -->
</div>
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasSteps" aria-labelledby="offcanvasStepsLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasStepsLabel">Pasos de la guía</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <p>Haga click en los pasos para visualizar acciones relacionadas con la guía</p>
    <mat-stepper orientation="vertical" [linear]="false" #stepper *ngIf="guideWatching !== undefined">
      <mat-step *ngFor="let step of guideWatching.steps; let i = index;" [completed]="i < currentStep">
        <ng-template matStepLabel>{{ step.title }}</ng-template>
        <button mat-button data-bs-dismiss="offcanvas">
          <a [href]="'/tutodo/see-guides/' + guideWatching.id + '#step' + i" target="_self"
            style="text-decoration: none;">Ir al paso</a>
        </button>
      </mat-step>
    </mat-stepper>
  </div>
</div>
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasIngredients" aria-labelledby="offcanvasIngredientsLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasIngredientsLabel">Ingredientes / materiales</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body" *ngIf="guideWatching">
    <p>Listado de los materiales o ingredientes necesarios para llevar a cabo la guía</p>
    <mat-list *ngFor="let ingredient of guideWatching.ingredients">
      <mat-list-item>{{ ingredient }}</mat-list-item>
    </mat-list>
    <h3 *ngIf="guideWatching.ingredients.length === 0">No hay ingredientes o materiales asociados a esta guía</h3>
  </div>
</div>